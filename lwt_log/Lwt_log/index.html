<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Lwt_log (lwt_log.Lwt_log)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> – <a href="../index.html">lwt_log</a> &#x00BB; Lwt_log</nav><header><h1>Module <code>Lwt_log</code></h1><p>Logging functions</p><p>This module provides logging functions. It is actually a thin extension of <a href="../Lwt_log_core/index.html"><code>Lwt_log_core</code></a>, adding logging destinations that are only available on Unix and Windows (such as files, standard output, and the system log). Being a thin extension, most of the functions in this module are actually the ones in <a href="../Lwt_log_core/index.html"><code>Lwt_log_core</code></a>. They are not repeated on this page, however, so please read both <a href="../Lwt_log_core/index.html"><code>Lwt_log_core</code></a> <em>and</em> this page for a complete understanding.</p><p>Here is a simple, self-contained usage example:</p><pre><code>let () =
  Lwt_log.default :=
    Lwt_log.channel
      ~template:&quot;$(date).$(milliseconds) [$(level)] $(message)&quot;
      ~close_mode:`Keep
      ~channel:Lwt_io.stdout
      ();

  Lwt_log.add_rule &quot;*&quot; Lwt_log.Info;

  Lwt_main.run begin
    Lwt_log.info &quot;Hello world!&quot;
  end

(* ocamlfind opt -linkpkg -package lwt.unix log_example.ml &amp;&amp; ./a.out *)</code></pre><p>As an alternative to this module, we suggest trying <a href="http://erratique.ch/software/logs/doc/Logs_lwt.html"><code>Logs_lwt</code></a> from the <a href="http://erratique.ch/software/logs"><code>logs</code></a> library.</p></header><div class="content"><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <a href="../Lwt_log_core/index.html">Lwt_log_core</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../Lwt_log_core/index.html#type-level">level</a> = <a href="../Lwt_log_core/index.html#type-level">Lwt_log_core.level</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="../Lwt_log_core/index.html#type-logger">logger</a> = <a href="../Lwt_log_core/index.html#type-logger">Lwt_log_core.logger</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="../Lwt_log_core/index.html#type-section">section</a> = <a href="../Lwt_log_core/index.html#type-section">Lwt_log_core.section</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="../Lwt_log_core/index.html#type-template">template</a> = <a href="../Lwt_log_core/index.html#type-template">Lwt_log_core.template</a> <span class="keyword">and</span> <span class="keyword">module</span> <a href="../Lwt_log_core/Section/index.html">Section</a> = <a href="../Lwt_log_core/Section/index.html">Lwt_log_core.Section</a></code></span></summary><aside><p>This module provides functions to deal with logging. It support:</p><ul><li>logging to multiple destination at the same time</li><li>filtering logs per destination</li></ul></aside><h3 id="types"><a href="#types" class="anchor"></a>Types</h3><div><div class="spec type" id="type-level" class="anchored"><a href="#type-level" class="anchor"></a><code><span class="keyword">type</span> level = <a href="../Lwt_log_core/index.html#type-level">Lwt_log_core.level</a> = </code><table><tr id="type-level.Debug" class="anchored"><td class="def variant constructor"><a href="#type-level.Debug" class="anchor"></a><code>| <span class="constructor">Debug</span></code></td><td class="doc"><p>Debugging message. They can be automatically removed by the syntax extension.</p></td></tr><tr id="type-level.Info" class="anchored"><td class="def variant constructor"><a href="#type-level.Info" class="anchor"></a><code>| <span class="constructor">Info</span></code></td><td class="doc"><p>Informational message. Suitable to be displayed when the program is in verbose mode.</p></td></tr><tr id="type-level.Notice" class="anchored"><td class="def variant constructor"><a href="#type-level.Notice" class="anchor"></a><code>| <span class="constructor">Notice</span></code></td><td class="doc"><p>Same as <a href="index.html#type-level.Info"><code>Info</code></a>, but is displayed by default.</p></td></tr><tr id="type-level.Warning" class="anchored"><td class="def variant constructor"><a href="#type-level.Warning" class="anchor"></a><code>| <span class="constructor">Warning</span></code></td><td class="doc"><p>Something strange happend</p></td></tr><tr id="type-level.Error" class="anchored"><td class="def variant constructor"><a href="#type-level.Error" class="anchor"></a><code>| <span class="constructor">Error</span></code></td><td class="doc"><p>An error message, which should not means the end of the program.</p></td></tr><tr id="type-level.Fatal" class="anchored"><td class="def variant constructor"><a href="#type-level.Fatal" class="anchor"></a><code>| <span class="constructor">Fatal</span></code></td><td class="doc"><p>A fatal error happened, in most cases the program will end after a fatal error.</p></td></tr></table></div><div><p>Type of log levels. A level determines the importance of a message</p></div></div><div><div class="spec type" id="type-logger" class="anchored"><a href="#type-logger" class="anchor"></a><code><span class="keyword">type</span> logger = <a href="../Lwt_log_core/index.html#type-logger">Lwt_log_core.logger</a></code></div><div><p>Type of a logger. A logger is responsible for dispatching messages and storing them somewhere.</p></div></div><div><div class="spec type" id="type-section" class="anchored"><a href="#type-section" class="anchor"></a><code><span class="keyword">type</span> section = <a href="../Lwt_log_core/index.html#type-section">Lwt_log_core.section</a></code></div><div><p>Each logging message has a section. Sections can be used to structure your logs. For example you can choose different loggers according to the section.</p><p>Each section carries a level, and messages with a lower log level than than the section level will be dropped.</p><p>Section levels are initialised using the contents of the <code>LWT_LOG</code> environment variable, which must contain one or more rules of the form <code>pattern -&gt; level</code> separated by &quot;;&quot;. Where <code>pattern</code> is a string that may contain <code>*</code>.</p><p>For example, if <code>LWT_LOG</code> contains:</p><pre><code>access -&gt; warning;
foo[*] -&gt; error</code></pre><p>then the level of the section <code>&quot;access&quot;</code> is <a href="index.html#type-level.Warning"><code>Warning</code></a> and the level of any section matching <code>&quot;foo[*]&quot;</code> is <a href="index.html#type-level.Error"><code>Error</code></a>.</p><p>If the pattern is omited in a rule then the pattern <code>&quot;*&quot;</code> is used instead, so <code>LWT_LOG</code> may just contain <code>&quot;debug&quot;</code> for instance.</p><p>By default, the following rule apply : <code>&quot;* -&gt; notice&quot;</code></p></div></div><div class="spec value" id="val-string_of_level" class="anchored"><a href="#val-string_of_level" class="anchor"></a><code><span class="keyword">val</span> string_of_level : <a href="index.html#type-level">level</a> <span>&#45;&gt;</span> string</code></div><div class="spec value" id="val-level_of_string" class="anchored"><a href="#val-level_of_string" class="anchor"></a><code><span class="keyword">val</span> level_of_string : string <span>&#45;&gt;</span> <span><a href="index.html#type-level">level</a> option</span></code></div><div><div class="spec value" id="val-load_rules" class="anchored"><a href="#val-load_rules" class="anchor"></a><code><span class="keyword">val</span> load_rules : <span>?&#8288;fail_on_error:bool</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></div><div><p>Reset the rules set when parsing the <code>LWT_LOG</code> environment variable using this string.</p><dl><dt>parameter fail_on_error</dt><dd><p>defines if the function will raise Failure if it encounters a malformed rule</p></dd></dl><dl><dt>raises Failure</dt><dd><p>if an invalid rule is found and <code>fail_on_error</code> is true</p><p><code>load_rules</code> parses the rules string and validates the rules before loading them. If <code>fail_on_error</code> is <code>true</code>, invalid rules will cause this function to raise <code>Failure</code> and leave existing rules unchanged. If <code>fail_on_error</code> is <code>false</code> (this is the default), it tries to load as many rules as possible and ignore invalid ones. If the rules string itself cannot be parsed, existing rules are always left unchanged.</p><p>Example:</p><pre><code>Lwt_log_core.load_rules ~fail_on_error:true &quot;* -&gt; nosuchlevel&quot; (* Raises Failure *)
Lwt_log_core.load_rules &quot;* -&gt; info&quot;</code></pre></dd></dl></div></div><div><div class="spec value" id="val-add_rule" class="anchored"><a href="#val-add_rule" class="anchor"></a><code><span class="keyword">val</span> add_rule : string <span>&#45;&gt;</span> <a href="index.html#type-level">level</a> <span>&#45;&gt;</span> unit</code></div><div><p><code>add_rule pattern level</code> adds a rule for sections logging levels. The rule is added before all other rules. It takes effect immediately and affects all sections for which the level has not been set explicitly with <a href="../Lwt_log_core/Section/index.html#val-set_level"><code>Section.set_level</code></a>. <code>pattern</code> may contains <code>*</code>. For example:</p><pre><code>Lwt_log_core.add_rule &quot;lwt*&quot; Lwt_log_core.Info</code></pre></div></div><div><div class="spec value" id="val-append_rule" class="anchored"><a href="#val-append_rule" class="anchor"></a><code><span class="keyword">val</span> append_rule : string <span>&#45;&gt;</span> <a href="index.html#type-level">level</a> <span>&#45;&gt;</span> unit</code></div><div><p><code>append_rule pattern level</code> adds the given rule after all other rules. For example to set the default fallback rule:</p><pre><code>Lwt_log_core.append_rule &quot;*&quot; Lwt_log_core.Info</code></pre></div></div><div><div class="spec value" id="val-reset_rules" class="anchored"><a href="#val-reset_rules" class="anchor"></a><code><span class="keyword">val</span> reset_rules : unit <span>&#45;&gt;</span> unit</code></div><div><p>removes all rules.</p></div></div><h3 id="logging-functions"><a href="#logging-functions" class="anchor"></a>Logging functions</h3><div><div class="spec value" id="val-log" class="anchored"><a href="#val-log" class="anchor"></a><code><span class="keyword">val</span> log : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span>level:<a href="index.html#type-level">level</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span></code></div><div><p><code>log ?section ?logger ~level message</code> logs a message.</p><p><code>section</code> defaults to <a href="../Lwt_log_core/Section/index.html#val-main"><code>Section.main</code></a>. If <code>logger</code> is not specified, then the default one is used instead (see <a href="index.html#val-default"><code>default</code></a>).</p><p>If <code>exn</code> is provided, then its string representation (= <code>Printexc.to_string exn</code>) will be append to the message, and if possible the backtrace will also be logged.</p><p><code>location</code> contains the location of the logging directive, it is of the form <code>(file_name, line, column)</code>.</p></div></div><div><div class="spec value" id="val-log_f" class="anchored"><a href="#val-log_f" class="anchor"></a><code><span class="keyword">val</span> log_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span>level:<a href="index.html#type-level">level</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span>)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div><p><code>log_f</code> is the same as <code>log</code> except that it takes a format string</p></div></div><div><div class="spec value" id="val-ign_log" class="anchored"><a href="#val-ign_log" class="anchor"></a><code><span class="keyword">val</span> ign_log : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span>level:<a href="index.html#type-level">level</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></div><div><p>Same as <a href="index.html#val-log"><code>log</code></a> but ignore the resulting thread.</p></div></div><div><div class="spec value" id="val-ign_log_f" class="anchored"><a href="#val-ign_log_f" class="anchor"></a><code><span class="keyword">val</span> ign_log_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span>level:<a href="index.html#type-level">level</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, unit)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div><p>Same as <a href="index.html#val-log_f"><code>log_f</code></a> but ignore the resulting thread.</p></div></div><aside><p>The following functions are the same as <a href="index.html#val-log"><code>log</code></a> except that their name determines which level is used.</p><p>For example <a href="index.html#val-info"><code>info</code></a><code> msg</code> is the same as <a href="index.html#val-log"><code>log</code></a><code> ~level:Info msg</code>.</p></aside><div class="spec value" id="val-debug" class="anchored"><a href="#val-debug" class="anchor"></a><code><span class="keyword">val</span> debug : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span></code></div><div class="spec value" id="val-debug_f" class="anchored"><a href="#val-debug_f" class="anchor"></a><code><span class="keyword">val</span> debug_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span>)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div class="spec value" id="val-ign_debug" class="anchored"><a href="#val-ign_debug" class="anchor"></a><code><span class="keyword">val</span> ign_debug : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></div><div class="spec value" id="val-ign_debug_f" class="anchored"><a href="#val-ign_debug_f" class="anchor"></a><code><span class="keyword">val</span> ign_debug_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, unit)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div class="spec value" id="val-info" class="anchored"><a href="#val-info" class="anchor"></a><code><span class="keyword">val</span> info : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span></code></div><div class="spec value" id="val-info_f" class="anchored"><a href="#val-info_f" class="anchor"></a><code><span class="keyword">val</span> info_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span>)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div class="spec value" id="val-ign_info" class="anchored"><a href="#val-ign_info" class="anchor"></a><code><span class="keyword">val</span> ign_info : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></div><div class="spec value" id="val-ign_info_f" class="anchored"><a href="#val-ign_info_f" class="anchor"></a><code><span class="keyword">val</span> ign_info_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, unit)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div class="spec value" id="val-notice" class="anchored"><a href="#val-notice" class="anchor"></a><code><span class="keyword">val</span> notice : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span></code></div><div class="spec value" id="val-notice_f" class="anchored"><a href="#val-notice_f" class="anchor"></a><code><span class="keyword">val</span> notice_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span>)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div class="spec value" id="val-ign_notice" class="anchored"><a href="#val-ign_notice" class="anchor"></a><code><span class="keyword">val</span> ign_notice : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></div><div class="spec value" id="val-ign_notice_f" class="anchored"><a href="#val-ign_notice_f" class="anchor"></a><code><span class="keyword">val</span> ign_notice_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, unit)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div class="spec value" id="val-warning" class="anchored"><a href="#val-warning" class="anchor"></a><code><span class="keyword">val</span> warning : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span></code></div><div class="spec value" id="val-warning_f" class="anchored"><a href="#val-warning_f" class="anchor"></a><code><span class="keyword">val</span> warning_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span>)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div class="spec value" id="val-ign_warning" class="anchored"><a href="#val-ign_warning" class="anchor"></a><code><span class="keyword">val</span> ign_warning : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></div><div class="spec value" id="val-ign_warning_f" class="anchored"><a href="#val-ign_warning_f" class="anchor"></a><code><span class="keyword">val</span> ign_warning_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, unit)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div class="spec value" id="val-error" class="anchored"><a href="#val-error" class="anchor"></a><code><span class="keyword">val</span> error : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span></code></div><div class="spec value" id="val-error_f" class="anchored"><a href="#val-error_f" class="anchor"></a><code><span class="keyword">val</span> error_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span>)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div class="spec value" id="val-ign_error" class="anchored"><a href="#val-ign_error" class="anchor"></a><code><span class="keyword">val</span> ign_error : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></div><div class="spec value" id="val-ign_error_f" class="anchored"><a href="#val-ign_error_f" class="anchor"></a><code><span class="keyword">val</span> ign_error_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, unit)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div class="spec value" id="val-fatal" class="anchored"><a href="#val-fatal" class="anchor"></a><code><span class="keyword">val</span> fatal : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span></code></div><div class="spec value" id="val-fatal_f" class="anchored"><a href="#val-fatal_f" class="anchor"></a><code><span class="keyword">val</span> fatal_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span>)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div class="spec value" id="val-ign_fatal" class="anchored"><a href="#val-ign_fatal" class="anchor"></a><code><span class="keyword">val</span> ign_fatal : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></div><div class="spec value" id="val-ign_fatal_f" class="anchored"><a href="#val-ign_fatal_f" class="anchor"></a><code><span class="keyword">val</span> ign_fatal_f : <span>?&#8288;exn:exn</span> <span>&#45;&gt;</span> <span>?&#8288;section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>?&#8288;location:<span>(string * int * int)</span></span> <span>&#45;&gt;</span> <span>?&#8288;logger:<a href="index.html#type-logger">logger</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, unit)</span> <a href="../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div><div class="spec module" id="module-Section" class="anchored"><a href="#module-Section" class="anchor"></a><code><span class="keyword">module</span> Section = <a href="../Lwt_log_core/Section/index.html">Lwt_log_core.Section</a></code></div><div><p>Sections</p></div></div><h3 id="log-templates"><a href="#log-templates" class="anchor"></a>Log templates</h3><div><div class="spec type" id="type-template" class="anchored"><a href="#type-template" class="anchor"></a><code><span class="keyword">type</span> template = <a href="../Lwt_log_core/index.html#type-template">Lwt_log_core.template</a></code></div><div><p>A template is for generating log messages.</p><p>It is a string which may contains variables of the form <code>$(var)</code>, where <code>var</code> is one of:</p><ul><li><code>message</code> which will be replaced by the message emited</li><li><code>level</code> which will be replaced by a string representation of the level</li><li><code>section</code> which will be replaced by the name of the message's section</li><li><code>loc-file</code> which will be replaced by the file name of the calling logging function</li><li><code>loc-line</code> which will be replaced by the line number of the calling logging function</li><li><code>loc-column</code> which will be replaced by the column number of the calling logging function</li></ul><p>For example:</p><ul><li><code>&quot;$(name): $(message)&quot;</code></li><li><code>&quot;$(name): $(loc-file): $(loc-line): $(loc-column): $(message)&quot;</code></li></ul></div></div><div><div class="spec value" id="val-render" class="anchored"><a href="#val-render" class="anchor"></a><code><span class="keyword">val</span> render : <span>buffer:<a href="../../ocaml/Stdlib/Buffer/index.html#type-t">Stdlib.Buffer.t</a></span> <span>&#45;&gt;</span> <span>template:<a href="index.html#type-template">template</a></span> <span>&#45;&gt;</span> <span>section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>level:<a href="index.html#type-level">level</a></span> <span>&#45;&gt;</span> <span>message:string</span> <span>&#45;&gt;</span> unit</code></div><div><p><code>render ~buffer ~template ~section ~level ~message</code> instantiate all variables of <code>template</code>, and store the result in <code>buffer</code>. The location is obtained from threads local storage.</p></div></div><div><div class="spec value" id="val-location_key" class="anchored"><a href="#val-location_key" class="anchor"></a><code><span class="keyword">val</span> location_key : <span><span>(string * int * int)</span> <a href="../../lwt/Lwt/index.html#type-key">Lwt.key</a></span></code></div><div><p>The key for storing current location.</p></div></div><h3 id="loggers"><a href="#loggers" class="anchor"></a>Loggers</h3><div><div class="spec exception" id="exception-Logger_closed" class="anchored"><a href="#exception-Logger_closed" class="anchor"></a><code><span class="keyword">exception</span> <span class="exception">Logger_closed</span></code></div><div><p>Exception raised when trying to use a closed logger</p></div></div><div><div class="spec value" id="val-make" class="anchored"><a href="#val-make" class="anchor"></a><code><span class="keyword">val</span> make : <span>output:<span>(<a href="index.html#type-section">section</a> <span>&#45;&gt;</span> <a href="index.html#type-level">level</a> <span>&#45;&gt;</span> <span>string list</span> <span>&#45;&gt;</span> <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span>)</span></span> <span>&#45;&gt;</span> <span>close:<span>(unit <span>&#45;&gt;</span> <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span>)</span></span> <span>&#45;&gt;</span> <a href="index.html#type-logger">logger</a></code></div><div><p><code>make ~output ~close</code> creates a new logger.</p><dl><dt>parameter output</dt><dd><p>is used to write logs. It is a function which receive a section, a level and a list lines that must be logged together.</p></dd></dl><dl><dt>parameter close</dt><dd><p>is used to close the logger.</p></dd></dl></div></div><div><div class="spec value" id="val-close" class="anchored"><a href="#val-close" class="anchor"></a><code><span class="keyword">val</span> close : <a href="index.html#type-logger">logger</a> <span>&#45;&gt;</span> <span>unit <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span></code></div><div><p>Close the given logger</p></div></div><div><div class="spec value" id="val-default" class="anchored"><a href="#val-default" class="anchor"></a><code><span class="keyword">val</span> default : <span><a href="index.html#type-logger">logger</a> <a href="../../ocaml/Stdlib/index.html#type-ref">Stdlib.ref</a></span></code></div><div><p>The default logger. It is used as default when no one is specified. If <code>Lwt_core</code> is linked (in the package <code>lwt.unix</code>) the default logger sends all messages to standard error. Otherwise the default logger is <a href="index.html#val-null"><code>null</code></a>.</p></div></div><div><div class="spec value" id="val-broadcast" class="anchored"><a href="#val-broadcast" class="anchor"></a><code><span class="keyword">val</span> broadcast : <span><a href="index.html#type-logger">logger</a> list</span> <span>&#45;&gt;</span> <a href="index.html#type-logger">logger</a></code></div><div><p><code>broadcast loggers</code> is a logger which send messages to all the given loggers.</p><p>Note: closing a broadcast logger does not close its components.</p></div></div><div><div class="spec value" id="val-dispatch" class="anchored"><a href="#val-dispatch" class="anchor"></a><code><span class="keyword">val</span> dispatch : <span>(<a href="index.html#type-section">section</a> <span>&#45;&gt;</span> <a href="index.html#type-level">level</a> <span>&#45;&gt;</span> <a href="index.html#type-logger">logger</a>)</span> <span>&#45;&gt;</span> <a href="index.html#type-logger">logger</a></code></div><div><p><code>dispatch f</code> is a logger which dispatch logging instructions to different logger according to their level and/or section.</p><p>Here is an example:</p><pre><code>let access_logger = Lwt_log.file &quot;access.log&quot;
and error_logger = Lwt_log.file &quot;error.log&quot; in

Lwt_log_core.dispatch
  (fun section level -&gt;
    match Lwt_log_core.Section.name section, level with
      | &quot;access&quot;, _ -&gt; access_logger
      | _, Lwt_log_core.Error -&gt; error_logger)</code></pre></div></div><h3 id="predefined-loggers"><a href="#predefined-loggers" class="anchor"></a>Predefined loggers</h3><div><div class="spec value" id="val-null" class="anchored"><a href="#val-null" class="anchor"></a><code><span class="keyword">val</span> null : <a href="index.html#type-logger">logger</a></code></div><div><p>Logger which drops everything</p></div></div></details></div></div></div><div><div class="spec value" id="val-render" class="anchored"><a href="#val-render" class="anchor"></a><code><span class="keyword">val</span> render : <span>buffer:<a href="../../ocaml/Stdlib/Buffer/index.html#type-t">Stdlib.Buffer.t</a></span> <span>&#45;&gt;</span> <span>template:<a href="index.html#type-template">template</a></span> <span>&#45;&gt;</span> <span>section:<a href="index.html#type-section">section</a></span> <span>&#45;&gt;</span> <span>level:<a href="index.html#type-level">level</a></span> <span>&#45;&gt;</span> <span>message:string</span> <span>&#45;&gt;</span> unit</code></div><div><p>Same as <a href="../Lwt_log_core/index.html#val-render"><code>Lwt_log_core.render</code></a>, except that the template may also contain the following variables:</p><ul><li><code>date</code>, which will be replaced with the current local date and time,</li><li><code>milliseconds</code>, which will be replaced by the fractional part of the current Unix time, to millisecond accuracy.</li></ul><p>For example:</p><ul><li><code>&quot;$(date) $(name)[$(pid)]: $(message)&quot;</code></li><li><code>&quot;$(date).$(milliseconds) $(name)[$(pid)]: $(message)&quot;</code></li><li><code>&quot;$(date): $(loc-file): $(loc-line): $(loc-column): $(message)&quot;</code></li></ul></div></div><div><div class="spec type" id="type-syslog_facility" class="anchored"><a href="#type-syslog_facility" class="anchor"></a><code><span class="keyword">type</span> syslog_facility = [ </code><table><tr id="type-syslog_facility.Auth" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Auth" class="anchor"></a><code>| </code><code>`Auth</code></td></tr><tr id="type-syslog_facility.Authpriv" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Authpriv" class="anchor"></a><code>| </code><code>`Authpriv</code></td></tr><tr id="type-syslog_facility.Cron" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Cron" class="anchor"></a><code>| </code><code>`Cron</code></td></tr><tr id="type-syslog_facility.Daemon" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Daemon" class="anchor"></a><code>| </code><code>`Daemon</code></td></tr><tr id="type-syslog_facility.FTP" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.FTP" class="anchor"></a><code>| </code><code>`FTP</code></td></tr><tr id="type-syslog_facility.Kernel" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Kernel" class="anchor"></a><code>| </code><code>`Kernel</code></td></tr><tr id="type-syslog_facility.Local0" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Local0" class="anchor"></a><code>| </code><code>`Local0</code></td></tr><tr id="type-syslog_facility.Local1" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Local1" class="anchor"></a><code>| </code><code>`Local1</code></td></tr><tr id="type-syslog_facility.Local2" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Local2" class="anchor"></a><code>| </code><code>`Local2</code></td></tr><tr id="type-syslog_facility.Local3" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Local3" class="anchor"></a><code>| </code><code>`Local3</code></td></tr><tr id="type-syslog_facility.Local4" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Local4" class="anchor"></a><code>| </code><code>`Local4</code></td></tr><tr id="type-syslog_facility.Local5" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Local5" class="anchor"></a><code>| </code><code>`Local5</code></td></tr><tr id="type-syslog_facility.Local6" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Local6" class="anchor"></a><code>| </code><code>`Local6</code></td></tr><tr id="type-syslog_facility.Local7" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Local7" class="anchor"></a><code>| </code><code>`Local7</code></td></tr><tr id="type-syslog_facility.LPR" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.LPR" class="anchor"></a><code>| </code><code>`LPR</code></td></tr><tr id="type-syslog_facility.Mail" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Mail" class="anchor"></a><code>| </code><code>`Mail</code></td></tr><tr id="type-syslog_facility.News" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.News" class="anchor"></a><code>| </code><code>`News</code></td></tr><tr id="type-syslog_facility.Syslog" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Syslog" class="anchor"></a><code>| </code><code>`Syslog</code></td></tr><tr id="type-syslog_facility.User" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.User" class="anchor"></a><code>| </code><code>`User</code></td></tr><tr id="type-syslog_facility.UUCP" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.UUCP" class="anchor"></a><code>| </code><code>`UUCP</code></td></tr><tr id="type-syslog_facility.NTP" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.NTP" class="anchor"></a><code>| </code><code>`NTP</code></td></tr><tr id="type-syslog_facility.Security" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Security" class="anchor"></a><code>| </code><code>`Security</code></td></tr><tr id="type-syslog_facility.Console" class="anchored"><td class="def constructor"><a href="#type-syslog_facility.Console" class="anchor"></a><code>| </code><code>`Console</code></td></tr></table><code> ]</code></div><div><p>Syslog facility. Look at the SYSLOG(3) man page for a description of syslog facilities</p></div></div><div><div class="spec value" id="val-syslog" class="anchored"><a href="#val-syslog" class="anchor"></a><code><span class="keyword">val</span> syslog : <span>?&#8288;template:<a href="index.html#type-template">template</a></span> <span>&#45;&gt;</span> <span>?&#8288;paths:<span>string list</span></span> <span>&#45;&gt;</span> <span>facility:<a href="index.html#type-syslog_facility">syslog_facility</a></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-logger">logger</a></code></div><div><p><code>syslog ?template ?paths ~facility ()</code> creates an logger which send message to the system logger.</p><dl><dt>parameter paths</dt><dd><p>is a list of path to try for the syslogd socket. It default to <code>[&quot;/dev/log&quot;; &quot;/var/run/log&quot;]</code>.</p></dd></dl><dl><dt>parameter template</dt><dd><p>defaults to <code>&quot;$(date) $(name)[$(pid)]: $(section): $(message)&quot;</code></p></dd></dl></div></div><div><div class="spec value" id="val-file" class="anchored"><a href="#val-file" class="anchor"></a><code><span class="keyword">val</span> file : <span>?&#8288;template:<a href="index.html#type-template">template</a></span> <span>&#45;&gt;</span> <span>?&#8288;mode:<span>[ `Truncate <span>| `Append</span> ]</span></span> <span>&#45;&gt;</span> <span>?&#8288;perm:<a href="../../ocaml/Unix/index.html#type-file_perm">Unix.file_perm</a></span> <span>&#45;&gt;</span> <span>file_name:string</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <span><a href="index.html#type-logger">logger</a> <a href="../../lwt/Lwt/index.html#type-t">Lwt.t</a></span></code></div><div><p><code>desf_file ?template ?mode ?perm ~file_name ()</code> creates an logger which will write messages to <code>file_name</code>.</p><ul><li>if <code>mode = `Truncate</code> then the file is truncated and previous contents will be lost.</li></ul><ul><li>if <code>mode = `Append</code>, new messages will be appended at the end of the file</li></ul><dl><dt>parameter mode</dt><dd><p>defaults to <code>`Append</code></p></dd></dl><dl><dt>parameter template</dt><dd><p>defaults to <code>&quot;$(date): $(section): $(message)&quot;</code></p></dd></dl></div></div><div><div class="spec value" id="val-channel" class="anchored"><a href="#val-channel" class="anchor"></a><code><span class="keyword">val</span> channel : <span>?&#8288;template:<a href="index.html#type-template">template</a></span> <span>&#45;&gt;</span> <span>close_mode:<span>[ `Close <span>| `Keep</span> ]</span></span> <span>&#45;&gt;</span> <span>channel:<a href="../../lwt/Lwt_io/index.html#type-output_channel">Lwt_io.output_channel</a></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-logger">logger</a></code></div><div><p><code>channel ?template ~close_mode ~channel ()</code> creates a logger from a channel.</p><p>If <code>close_mode = `Close</code> then <code>channel</code> is closed when the logger is closed, otherwise it is left open.</p><dl><dt>parameter template</dt><dd><p>defaults to <code>&quot;$(name): $(section): $(message)&quot;</code></p></dd></dl></div></div></div></body></html>